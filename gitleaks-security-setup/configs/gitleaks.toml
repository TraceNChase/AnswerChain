# Gitleaks configuration file
# Documentation: https://github.com/gitleaks/gitleaks#configuration

title = "Gitleaks Config"

# Use the default rules
[allowlist]
description = "Global allowlist patterns"
paths = [
    '''node_modules''',
    '''vendor''',
    '''\.git/''',
    '''\.yarn/''',
    '''yarn\.lock''',
    '''package-lock\.json''',
    '''go\.sum''',
    '''testdata/''',
    '''__mock__/''',
    '''__tests__/''',
    '''test/fixtures/''',
    '''\.min\.js$''',
    '''\.svg$''',
    '''\.png$''',
    '''\.jpeg$''',
    '''\.jpg$''',
    '''\.webpack\.js$''',
]

regexes = [
    '''FAKE[_-]?KEY''',
    '''EXAMPLE[_-]?KEY''',
    '''SAMPLE[_-]?KEY''',
    '''TEST[_-]?KEY''',
    '''PLACEHOLDER[_-]?KEY''',
    '''dont-commit-me''',
    '''localhost'''
]

commits = [
    # Add specific commit hashes to exclude here
]

# Add custom detection rules here
[[rules]]
id = "high-entropy-base64"
description = "Detect high entropy base64 strings that could be keys/secrets"
regex = '''(?i)(?P<key>(eyj|mf2)[a-z0-9_=-]{40,})'''
entropy = 5.5
secret-group = 1
allowlist = [
    '''AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=''',
]

[[rules]]
id = "github-pat"
description = "GitHub Personal Access Token"
regex = '''ghp_[a-zA-Z0-9]{36}'''
secret-group = 0
allowlist = []

[[rules]]
id = "aws-access-key"
description = "AWS Access Key"
regex = '''(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}'''
secret-group = 0
allowlist = []

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN ((RSA|DSA|EC|PGP|OPENSSH) )?PRIVATE KEY( BLOCK)?-----'''
secret-group = 0
allowlist = []

# Add more custom rules as needed
